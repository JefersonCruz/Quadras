(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8733],{18763:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(40157).A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},52899:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>k});var t=s(95155),r=s(16976),l=s(66695),d=s(54683),i=s(75074),n=s(50172),o=s(18763),c=s(62523),m=s(30285),u=s(85127),p=s(54165),x=s(85057),f=s(59409),h=s(40283),j=s(67039),y=s(35317),N=s(12115),g=s(87481),b=s(62177),v=s(90221),w=s(71153);let A=w.z.object({role:w.z.enum(["user","admin"],{required_error:"Selecione um papel."})});function k(){let{user:e,isAdmin:a}=(0,h.A)(),{toast:s}=(0,g.dj)(),[w,k]=(0,N.useState)([]),[C,E]=(0,N.useState)(!0),[z,P]=(0,N.useState)(""),[R,S]=(0,N.useState)(!1),[U,L]=(0,N.useState)(null),[q,H]=(0,N.useState)(!1),{control:J,handleSubmit:_,reset:M,setValue:F,formState:{errors:G}}=(0,b.mN)({resolver:(0,v.u)(A)}),V=(0,N.useCallback)(async()=>{if(e&&a){E(!0);try{let e=(0,y.rJ)(j.db,"usuarios"),a=(await (0,y.GG)(e)).docs.map(e=>({id:e.id,...e.data()}));k(a)}catch(e){console.error("Error fetching users:",e),s({title:"Erro ao buscar usu\xe1rios",description:"N\xe3o foi poss\xedvel carregar a lista de usu\xe1rios.",variant:"destructive"})}finally{E(!1)}}},[e,a,s]);(0,N.useEffect)(()=>{V()},[V]);let Z=e=>{L(e),F("role",e.role||"user"),S(!0)},I=async e=>{if(!U||!U.id||!a){s({title:"Erro",description:"Usu\xe1rio n\xe3o selecionado ou permiss\xe3o negada.",variant:"destructive"});return}H(!0);try{let a=(0,y.H9)(j.db,"usuarios",U.id);await (0,y.mZ)(a,{role:e.role}),s({title:"Papel Atualizado!",description:"O papel de ".concat(U.nome||U.email," foi alterado para ").concat(e.role,".")}),S(!1),L(null),V()}catch(e){console.error("Error updating user role:",e),s({title:"Erro ao Atualizar Papel",description:"N\xe3o foi poss\xedvel alterar o papel do usu\xe1rio.",variant:"destructive"})}finally{H(!1)}},O=w.filter(e=>e.nome&&e.nome.toLowerCase().includes(z.toLowerCase())||e.email.toLowerCase().includes(z.toLowerCase()));return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(r.A,{title:"Gerenciamento de Usu\xe1rios",description:"Visualize e gerencie os usu\xe1rios da plataforma."}),(0,t.jsxs)(l.Zp,{children:[(0,t.jsxs)(l.aR,{children:[(0,t.jsxs)(l.ZB,{className:"flex items-center",children:[(0,t.jsx)(d.A,{className:"mr-2 text-primary"})," Lista de Usu\xe1rios"]}),(0,t.jsxs)("div",{className:"mt-2 relative",children:[(0,t.jsx)(c.p,{placeholder:"Buscar usu\xe1rio por nome ou email...",value:z,onChange:e=>P(e.target.value),className:"max-w-sm pl-10"}),(0,t.jsx)(i.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"})]})]}),(0,t.jsx)(l.Wu,{children:C?(0,t.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,t.jsx)(n.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,t.jsx)("p",{className:"ml-2",children:"Carregando usu\xe1rios..."})]}):0===O.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(d.A,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-foreground",children:"Nenhum usu\xe1rio encontrado."}),(0,t.jsx)("p",{className:"text-muted-foreground",children:z?"Tente um termo de busca diferente.":"N\xe3o h\xe1 usu\xe1rios cadastrados no momento."})]}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(u.XI,{children:[(0,t.jsx)(u.A0,{children:(0,t.jsxs)(u.Hj,{children:[(0,t.jsx)(u.nd,{children:"Nome"}),(0,t.jsx)(u.nd,{children:"Email"}),(0,t.jsx)(u.nd,{children:"Papel"}),(0,t.jsx)(u.nd,{children:"Plano"}),(0,t.jsx)(u.nd,{children:"ID do Usu\xe1rio"}),(0,t.jsx)(u.nd,{className:"text-right",children:"A\xe7\xf5es"})]})}),(0,t.jsx)(u.BF,{children:O.map(a=>(0,t.jsxs)(u.Hj,{children:[(0,t.jsx)(u.nA,{className:"font-medium",children:a.nome||"N/A"}),(0,t.jsx)(u.nA,{children:a.email}),(0,t.jsx)(u.nA,{children:(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded-full font-medium\n                          ".concat("admin"===a.role?"bg-destructive/80 text-destructive-foreground":"bg-accent text-accent-foreground"),children:a.role||"user"})}),(0,t.jsx)(u.nA,{children:(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded-full font-medium\n                          ".concat("premium"===a.tipoPlano?"bg-primary/80 text-primary-foreground":"bg-muted text-muted-foreground"),children:a.tipoPlano||"gratuito"})}),(0,t.jsx)(u.nA,{className:"text-xs text-muted-foreground",children:a.id}),(0,t.jsxs)(u.nA,{className:"text-right space-x-2",children:[(0,t.jsxs)(m.$,{variant:"outline",size:"sm",onClick:()=>Z(a),disabled:a.id===(null==e?void 0:e.uid),children:[(0,t.jsx)(o.A,{className:"h-3 w-3 mr-1"})," Editar Papel"]}),(0,t.jsx)(m.$,{variant:"destructive",size:"sm",disabled:!0,children:"Excluir"})," "]})]},a.id))})]})})})]}),U&&(0,t.jsx)(p.lG,{open:R,onOpenChange:e=>{S(e),e||L(null)},children:(0,t.jsxs)(p.Cf,{className:"sm:max-w-md",children:[(0,t.jsxs)(p.c7,{children:[(0,t.jsx)(p.L3,{children:"Editar Papel do Usu\xe1rio"}),(0,t.jsxs)(p.rr,{children:["Alterar o papel de ",(0,t.jsx)("span",{className:"font-semibold",children:U.nome||U.email}),"."]})]}),(0,t.jsxs)("form",{onSubmit:_(I),className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(x.J,{htmlFor:"role",children:"Papel"}),(0,t.jsx)(b.xI,{name:"role",control:J,render:e=>{let{field:a}=e;return(0,t.jsxs)(f.l6,{onValueChange:a.onChange,value:a.value,children:[(0,t.jsx)(f.bq,{id:"role",children:(0,t.jsx)(f.yv,{placeholder:"Selecione um papel"})}),(0,t.jsxs)(f.gC,{children:[(0,t.jsx)(f.eb,{value:"user",children:"Usu\xe1rio (user)"}),(0,t.jsx)(f.eb,{value:"admin",children:"Administrador (admin)"})]})]})}}),G.role&&(0,t.jsx)("p",{className:"text-sm text-destructive mt-1",children:G.role.message})]}),(0,t.jsxs)(p.Es,{children:[(0,t.jsx)(p.HM,{asChild:!0,children:(0,t.jsx)(m.$,{type:"button",variant:"outline",onClick:()=>{S(!1),L(null)},children:"Cancelar"})}),(0,t.jsx)(m.$,{type:"submit",disabled:q,children:q?(0,t.jsx)(n.A,{className:"mr-2 h-4 w-4 animate-spin"}):"Salvar Altera\xe7\xf5es"})]})]})]})})]})}},54165:(e,a,s)=>{"use strict";s.d(a,{Cf:()=>u,Es:()=>x,HM:()=>c,L3:()=>f,c7:()=>p,lG:()=>n,rr:()=>h});var t=s(95155),r=s(12115),l=s(15452),d=s(25318),i=s(59434);let n=l.bL;l.l9;let o=l.ZL,c=l.bm,m=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.hJ,{ref:a,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});m.displayName=l.hJ.displayName;let u=r.forwardRef((e,a)=>{let{className:s,children:r,...n}=e;return(0,t.jsxs)(o,{children:[(0,t.jsx)(m,{}),(0,t.jsxs)(l.UC,{ref:a,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...n,children:[r,(0,t.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(d.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=l.UC.displayName;let p=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...s})};p.displayName="DialogHeader";let x=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...s})};x.displayName="DialogFooter";let f=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.hE,{ref:a,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});f.displayName=l.hE.displayName;let h=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.VY,{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})});h.displayName=l.VY.displayName},54683:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(40157).A)("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]])},59409:(e,a,s)=>{"use strict";s.d(a,{bq:()=>u,eb:()=>h,gC:()=>f,l6:()=>c,yv:()=>m});var t=s(95155),r=s(12115),l=s(31992),d=s(79556),i=s(77381),n=s(10518),o=s(59434);let c=l.bL;l.YJ;let m=l.WT,u=r.forwardRef((e,a)=>{let{className:s,children:r,...i}=e;return(0,t.jsxs)(l.l9,{ref:a,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...i,children:[r,(0,t.jsx)(l.In,{asChild:!0,children:(0,t.jsx)(d.A,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=l.l9.displayName;let p=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.PP,{ref:a,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,t.jsx)(i.A,{className:"h-4 w-4"})})});p.displayName=l.PP.displayName;let x=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.wn,{ref:a,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,t.jsx)(d.A,{className:"h-4 w-4"})})});x.displayName=l.wn.displayName;let f=r.forwardRef((e,a)=>{let{className:s,children:r,position:d="popper",...i}=e;return(0,t.jsx)(l.ZL,{children:(0,t.jsxs)(l.UC,{ref:a,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===d&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:d,...i,children:[(0,t.jsx)(p,{}),(0,t.jsx)(l.LM,{className:(0,o.cn)("p-1","popper"===d&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,t.jsx)(x,{})]})})});f.displayName=l.UC.displayName,r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.JU,{ref:a,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=l.JU.displayName;let h=r.forwardRef((e,a)=>{let{className:s,children:r,...d}=e;return(0,t.jsxs)(l.q7,{ref:a,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...d,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(l.VF,{children:(0,t.jsx)(n.A,{className:"h-4 w-4"})})}),(0,t.jsx)(l.p4,{children:r})]})});h.displayName=l.q7.displayName,r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.wv,{ref:a,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=l.wv.displayName},75074:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(40157).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},85057:(e,a,s)=>{"use strict";s.d(a,{J:()=>o});var t=s(95155),r=s(12115),l=s(40968),d=s(74466),i=s(59434);let n=(0,d.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.b,{ref:a,className:(0,i.cn)(n(),s),...r})});o.displayName=l.b.displayName},90342:(e,a,s)=>{Promise.resolve().then(s.bind(s,52899))}},e=>{var a=a=>e(e.s=a);e.O(0,[2992,6073,668,9023,167,2356,9397,7589,3470,4443,8200,7752,8441,1684,7358],()=>a(90342)),_N_E=e.O()}]);