(()=>{var e={};e.id=636,e.ids=[636],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8086:e=>{"use strict";e.exports=require("module")},9689:(e,s,r)=>{Promise.resolve().then(r.bind(r,29912))},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29912:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>t});let t=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/dashboard/projects/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/dashboard/projects/page.tsx","default")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37366:e=>{"use strict";e.exports=require("dns")},38067:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>F});var t=r(60687),a=r(70054),i=r(29523),o=r(44493),n=r(35265),d=r(11516),l=r(41936),c=r(33886),u=r(82614);let x=(0,u.A)("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),h=(0,u.A)("Tags",[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]]);var m=r(35137),p=r(57207),j=r(63503),v=r(89667),f=r(80013),b=r(34729),y=r(15079),g=r(27605),N=r(63442),C=r(9275),w=r(63213),P=r(71557),k=r(75535),A=r(43210),q=r(29867),_=r(6211),E=r(55925),I=r(73437),S=r(94229),z=r(16189),$=r(42446),M=r(76242);let G=C.z.object({nome:C.z.string().min(3,"Nome do projeto deve ter no m\xednimo 3 caracteres."),descricao:C.z.string().optional(),clienteId:C.z.string().min(1,"Selecione um cliente."),status:C.z.enum(["Planejamento","Em Andamento","Conclu\xeddo","Cancelado"])});function F(){let{user:e}=(0,w.A)(),{toast:s}=(0,q.dj)();(0,z.useRouter)(),(0,z.useSearchParams)(),(0,z.usePathname)();let[r,u]=(0,A.useState)([]),[C,F]=(0,A.useState)([]),[B,Z]=(0,A.useState)(!0),[D,J]=(0,A.useState)(!1),[L,T]=(0,A.useState)({}),[H,O]=(0,A.useState)(""),[R,V]=(0,A.useState)(!1),[X,K]=(0,A.useState)(null),{control:W,handleSubmit:Q,reset:U,formState:{errors:Y}}=(0,g.mN)({resolver:(0,N.u)(G),defaultValues:{nome:"",descricao:"",clienteId:"",status:"Planejamento"}}),ee=(0,A.useCallback)(async()=>{if(e){Z(!0);try{let s=(0,k.P)((0,k.rJ)(P.db,"clientes"),(0,k._M)("owner","==",e.uid)),r=(await (0,k.GG)(s)).docs.map(e=>({id:e.id,...e.data()}));F(r);let t=(0,k.P)((0,k.rJ)(P.db,"projetos"),(0,k._M)("owner","==",e.uid),(0,k.My)("dataCriacao","desc")),a=(await (0,k.GG)(t)).docs.map(e=>({id:e.id,...e.data()}));u(a)}catch(e){console.error("Erro ao buscar projetos ou clientes:",e),s({title:"Erro ao buscar dados",description:"N\xe3o foi poss\xedvel carregar projetos e clientes.",variant:"destructive"})}finally{Z(!1)}}},[e,s]),es=(0,A.useCallback)(()=>{K(null),V(!0)},[V,K]),er=async r=>{if(e){J(!0);try{let t={...r,owner:e.uid,dataCriacao:X?.dataCriacao||k.Dc.now()};if(X&&X.id){let e=(0,k.H9)(P.db,"projetos",X.id);await (0,k.mZ)(e,t),s({title:"Projeto atualizado!",description:"Os dados do projeto foram atualizados."})}else await (0,k.gS)((0,k.rJ)(P.db,"projetos"),t),s({title:"Projeto adicionado!",description:"Novo projeto cadastrado com sucesso."});ee(),V(!1),K(null)}catch(e){console.error(e),s({title:"Erro ao salvar projeto",description:"N\xe3o foi poss\xedvel salvar os dados.",variant:"destructive"})}finally{J(!1)}}},et=async e=>{T(s=>({...s,[e]:!0}));try{await (0,k.kd)((0,k.H9)(P.db,"projetos",e)),s({title:"Projeto exclu\xeddo",description:"O projeto foi removido com sucesso."}),ee()}catch(e){s({title:"Erro ao excluir",description:"N\xe3o foi poss\xedvel remover o projeto.",variant:"destructive"})}finally{T(s=>({...s,[e]:!1}))}},ea=async r=>{if(e){T(e=>({...e,[`pdf_${r}`]:!0}));try{let t=(0,k.P)((0,k.rJ)(P.db,"fichasTecnicas"),(0,k._M)("owner","==",e.uid),(0,k._M)("projetoId","==",r),(0,k.My)("dataCriacao","desc"),(0,k.AB)(1)),a=await (0,k.GG)(t);if(a.empty){s({title:"Nenhuma Ficha Encontrada",description:"N\xe3o h\xe1 fichas t\xe9cnicas para este projeto.",variant:"default"});return}let i=a.docs[0],o={id:i.id,...i.data()};await (0,$.M)(o),s({title:"PDF Gerado!",description:"O download da ficha t\xe9cnica foi iniciado."})}catch(e){s({title:"Erro ao Baixar Ficha",description:e.message||"N\xe3o foi poss\xedvel baixar a ficha t\xe9cnica.",variant:"destructive"})}finally{T(e=>({...e,[`pdf_${r}`]:!1}))}}},ei=e=>{K(e),V(!0)},eo=r.filter(e=>{let s=C.find(s=>s.id===e.clienteId)?.nome,r=H.toLowerCase();return e.nome.toLowerCase().includes(r)||s&&s.toLowerCase().includes(r)}),en=e=>C.find(s=>s.id===e)?.nome||"Desconhecido",ed=["Planejamento","Em Andamento","Conclu\xeddo","Cancelado"];return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(a.A,{title:"Gerenciamento de Projetos",description:"Crie, edite e acompanhe o status dos seus projetos.",actions:(0,t.jsxs)(i.$,{onClick:es,children:[(0,t.jsx)(n.A,{className:"mr-2 h-4 w-4"})," Novo Projeto"]})}),(0,t.jsx)(j.lG,{open:R,onOpenChange:e=>{V(e),e||K(null)},children:(0,t.jsxs)(j.Cf,{className:"sm:max-w-lg",children:[(0,t.jsxs)(j.c7,{children:[(0,t.jsx)(j.L3,{children:X?"Editar Projeto":"Novo Projeto"}),(0,t.jsx)(j.rr,{children:X?"Atualize os dados do projeto.":"Preencha os dados para cadastrar um novo projeto."})]}),(0,t.jsxs)("form",{onSubmit:Q(er),className:"space-y-4 py-4 max-h-[70vh] overflow-y-auto pr-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(f.J,{htmlFor:"nome",children:"Nome do Projeto"}),(0,t.jsx)(g.xI,{name:"nome",control:W,render:({field:e})=>(0,t.jsx)(v.p,{id:"nome",...e})}),Y.nome&&(0,t.jsx)("p",{className:"text-sm text-destructive mt-1",children:Y.nome.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f.J,{htmlFor:"clienteId",children:"Cliente"}),(0,t.jsx)(g.xI,{name:"clienteId",control:W,render:({field:e})=>(0,t.jsxs)(y.l6,{onValueChange:e.onChange,value:e.value,defaultValue:e.value,children:[(0,t.jsx)(y.bq,{id:"clienteId",children:(0,t.jsx)(y.yv,{placeholder:"Selecione um cliente"})}),(0,t.jsxs)(y.gC,{children:[0===C.length&&(0,t.jsx)("p",{className:"p-2 text-sm text-muted-foreground",children:"Nenhum cliente cadastrado."}),C.map(e=>(0,t.jsx)(y.eb,{value:e.id,children:e.nome},e.id))]})]})}),Y.clienteId&&(0,t.jsx)("p",{className:"text-sm text-destructive mt-1",children:Y.clienteId.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f.J,{htmlFor:"status",children:"Status"}),(0,t.jsx)(g.xI,{name:"status",control:W,render:({field:e})=>(0,t.jsxs)(y.l6,{onValueChange:e.onChange,value:e.value,defaultValue:e.value,children:[(0,t.jsx)(y.bq,{id:"status",children:(0,t.jsx)(y.yv,{placeholder:"Selecione o status"})}),(0,t.jsx)(y.gC,{children:ed.map(e=>(0,t.jsx)(y.eb,{value:e,children:e},e))})]})}),Y.status&&(0,t.jsx)("p",{className:"text-sm text-destructive mt-1",children:Y.status.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f.J,{htmlFor:"descricao",children:"Descri\xe7\xe3o"}),(0,t.jsx)(g.xI,{name:"descricao",control:W,render:({field:e})=>(0,t.jsx)(b.T,{id:"descricao",...e,placeholder:"Detalhes sobre o projeto..."})})]}),(0,t.jsxs)(j.Es,{className:"sticky bottom-0 bg-background py-4",children:[(0,t.jsx)(j.HM,{asChild:!0,children:(0,t.jsx)(i.$,{type:"button",variant:"outline",children:"Cancelar"})}),(0,t.jsx)(i.$,{type:"submit",disabled:D,children:D?(0,t.jsx)(d.A,{className:"mr-2 h-4 w-4 animate-spin"}):"Salvar Projeto"})]})]})]})}),(0,t.jsxs)(o.Zp,{children:[(0,t.jsxs)(o.aR,{children:[(0,t.jsx)(o.ZB,{children:"Lista de Projetos"}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(v.p,{placeholder:"Buscar projeto ou cliente...",value:H,onChange:e=>O(e.target.value),className:"max-w-sm",icon:(0,t.jsx)(l.A,{className:"h-4 w-4 text-muted-foreground"})})})]}),(0,t.jsx)(o.Wu,{children:B?(0,t.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,t.jsx)(d.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,t.jsx)("p",{className:"ml-2",children:"Carregando projetos..."})]}):0===eo.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(c.A,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-foreground",children:"Nenhum projeto encontrado."}),(0,t.jsx)("p",{className:"text-muted-foreground",children:H?"Tente um termo de busca diferente ou verifique os filtros.":"Comece adicionando seu primeiro projeto."}),!H&&(0,t.jsxs)(i.$,{onClick:es,className:"mt-4",children:[(0,t.jsx)(n.A,{className:"mr-2 h-4 w-4"})," Adicionar Projeto"]})]}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsx)(M.Bc,{children:(0,t.jsxs)(_.XI,{children:[(0,t.jsx)(_.A0,{children:(0,t.jsxs)(_.Hj,{children:[(0,t.jsx)(_.nd,{children:"Nome do Projeto"}),(0,t.jsx)(_.nd,{children:"Cliente"}),(0,t.jsx)(_.nd,{children:"Status"}),(0,t.jsx)(_.nd,{children:"Data de Cria\xe7\xe3o"}),(0,t.jsx)(_.nd,{className:"text-right",children:"A\xe7\xf5es"})]})}),(0,t.jsx)(_.BF,{children:eo.map(e=>(0,t.jsxs)(_.Hj,{children:[(0,t.jsx)(_.nA,{className:"font-medium",children:e.nome}),(0,t.jsx)(_.nA,{children:en(e.clienteId)}),(0,t.jsx)(_.nA,{children:(0,t.jsx)("span",{className:`px-2 py-1 text-xs rounded-full font-medium
                          ${"Conclu\xeddo"===e.status?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-300":"Em Andamento"===e.status?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300":"Planejamento"===e.status?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/50 dark:text-yellow-300":"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300"}`,children:e.status})}),(0,t.jsx)(_.nA,{children:e.dataCriacao?(0,I.GP)(e.dataCriacao.toDate(),"dd/MM/yyyy",{locale:S.F}):"-"}),(0,t.jsxs)(_.nA,{className:"text-right space-x-1",children:[(0,t.jsxs)(M.m_,{children:[(0,t.jsx)(M.k$,{asChild:!0,children:(0,t.jsxs)(i.$,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>ea(e.id),disabled:L[`pdf_${e.id}`],children:[L[`pdf_${e.id}`]?(0,t.jsx)(d.A,{className:"h-4 w-4 animate-spin"}):(0,t.jsx)(x,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Baixar Ficha T\xe9cnica"})]})}),(0,t.jsx)(M.ZI,{children:(0,t.jsx)("p",{children:"Baixar Ficha T\xe9cnica"})})]}),(0,t.jsxs)(M.m_,{children:[(0,t.jsx)(M.k$,{asChild:!0,children:(0,t.jsxs)(i.$,{variant:"outline",size:"icon",className:"h-8 w-8",disabled:!0,children:[(0,t.jsx)(h,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Baixar Etiquetas"})]})}),(0,t.jsx)(M.ZI,{children:(0,t.jsx)("p",{children:"Baixar Etiquetas (em breve)"})})]}),(0,t.jsxs)(M.m_,{children:[(0,t.jsx)(M.k$,{asChild:!0,children:(0,t.jsxs)(i.$,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>ei(e),children:[(0,t.jsx)(m.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Editar Projeto"})]})}),(0,t.jsx)(M.ZI,{children:(0,t.jsx)("p",{children:"Editar Projeto"})})]}),(0,t.jsxs)(E.Lt,{children:[(0,t.jsx)(E.tv,{asChild:!0,children:(0,t.jsxs)(M.m_,{children:[(0,t.jsx)(M.k$,{asChild:!0,children:(0,t.jsxs)(i.$,{variant:"destructive",size:"icon",className:"h-8 w-8",disabled:L[e.id],children:[(0,t.jsx)(p.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Excluir Projeto"})]})}),(0,t.jsx)(M.ZI,{children:(0,t.jsx)("p",{children:"Excluir Projeto"})})]})}),(0,t.jsxs)(E.EO,{children:[(0,t.jsxs)(E.wd,{children:[(0,t.jsx)(E.r7,{children:"Confirmar Exclus\xe3o"}),(0,t.jsxs)(E.$v,{children:['Tem certeza que deseja excluir o projeto "',e.nome,'"? Esta a\xe7\xe3o n\xe3o pode ser desfeita.']})]}),(0,t.jsxs)(E.ck,{children:[(0,t.jsx)(E.Zr,{children:"Cancelar"}),(0,t.jsxs)(E.Rx,{onClick:()=>et(e.id),disabled:L[e.id],children:[L[e.id]?(0,t.jsx)(d.A,{className:"animate-spin h-4 w-4 mr-2"}):null," Excluir"]})]})]})]})]})]},e.id))})]})})})})]})]})}},41936:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(82614).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},69320:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>l});var t=r(65239),a=r(48088),i=r(88170),o=r.n(i),n=r(30893),d={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);r.d(s,d);let l={children:["",{children:["dashboard",{children:["projects",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,29912)),"/home/user/studio/src/app/dashboard/projects/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,63144)),"/home/user/studio/src/app/dashboard/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/home/user/studio/src/app/dashboard/projects/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/dashboard/projects/page",pathname:"/dashboard/projects",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},80313:(e,s,r)=>{Promise.resolve().then(r.bind(r,38067))},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[447,75,707,422,825,121,729,169,277,848,546,828],()=>r(69320));module.exports=t})();