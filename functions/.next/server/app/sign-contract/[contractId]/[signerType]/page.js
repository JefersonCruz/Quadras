(()=>{var e={};e.id=784,e.ids=[784],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11246:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>l});var a=s(65239),r=s(48088),n=s(88170),o=s.n(n),i=s(30893),d={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let l={children:["",{children:["sign-contract",{children:["[contractId]",{children:["[signerType]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,41502)),"/home/user/studio/src/app/sign-contract/[contractId]/[signerType]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,46870)),"/home/user/studio/src/app/sign-contract/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,94431)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/home/user/studio/src/app/sign-contract/[contractId]/[signerType]/page.tsx"],m={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/sign-contract/[contractId]/[signerType]/page",pathname:"/sign-contract/[contractId]/[signerType]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},36644:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(82614).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},37366:e=>{"use strict";e.exports=require("dns")},41502:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/sign-contract/[contractId]/[signerType]/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/sign-contract/[contractId]/[signerType]/page.tsx","default")},44493:(e,t,s)=>{"use strict";s.d(t,{BT:()=>l,Wu:()=>c,ZB:()=>d,Zp:()=>o,aR:()=>i,wL:()=>m});var a=s(60687),r=s(43210),n=s(4780);let o=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)("div",{ref:s,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));o.displayName="Card";let i=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...t}));i.displayName="CardHeader";let d=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)("div",{ref:s,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));d.displayName="CardTitle";let l=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)("div",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));l.displayName="CardDescription";let c=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent";let m=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",e),...t}));m.displayName="CardFooter"},46870:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u,metadata:()=>m});var a=s(37413),r=s(90848),n=s.n(r),o=s(46680),i=s.n(o);s(61135);var d=s(79737);let l=n(),c=i(),m={title:"Assinatura de Contrato - ANODE Lite",description:"P\xe1gina para assinatura de contratos digitais."};function u({children:e}){return(0,a.jsx)("html",{lang:"pt-BR",suppressHydrationWarning:!0,children:(0,a.jsxs)("body",{className:`${l.variable} ${c.variable} antialiased font-sans bg-background text-foreground`,children:[(0,a.jsx)("main",{className:"flex flex-col items-center justify-center min-h-screen p-4",children:e}),(0,a.jsx)(d.Toaster,{})]})})}},47016:(e,t,s)=>{Promise.resolve().then(s.bind(s,14947))},53465:(e,t,s)=>{Promise.resolve().then(s.bind(s,41502))},55511:e=>{"use strict";e.exports=require("crypto")},60168:(e,t,s)=>{Promise.resolve().then(s.bind(s,79737))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66617:(e,t,s)=>{Promise.resolve().then(s.bind(s,73796))},70440:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var a=s(31658);let r=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},73496:e=>{"use strict";e.exports=require("http2")},73796:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var a=s(60687),r=s(43210),n=s(16189),o=s(75535),i=s(71557),d=s(44493),l=s(29523),c=s(11516),m=s(82614);let u=(0,m.A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var p=s(36644);let x=(0,m.A)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),h=(0,m.A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var f=s(29867),g=s(85814),j=s.n(g),b=s(73437),v=s(94229);function y(){let e=(0,n.useParams)();(0,n.useRouter)();let{toast:t}=(0,f.dj)();e.contractId,e.signerType;let[s,m]=(0,r.useState)(null),[g,y]=(0,r.useState)(!0),[N,w]=(0,r.useState)(null),[k,C]=(0,r.useState)(!1),[A,q]=(0,r.useState)(null),P=()=>!!s&&!!A&&!!s.assinaturas&&!!A.keyInFirestore&&!!s.assinaturas[A.keyInFirestore]?.dataHora,E=async()=>{if(!s||!s.id||!A||!A.keyInFirestore){t({title:"Erro",description:"Dados do contrato ou informa\xe7\xf5es do assinante ausentes.",variant:"destructive"});return}if(P()){t({title:"J\xe1 Assinado",description:"Este contrato j\xe1 foi assinado por voc\xea.",variant:"default"});return}if("assinado"===s.status||"cancelado"===s.status){t({title:"Contrato Finalizado",description:`Este contrato j\xe1 est\xe1 ${s.status}. N\xe3o pode mais ser assinado.`,variant:"default"});return}C(!0);try{let e=(0,o.H9)(i.db,"contratos",s.id),a={nome:A.name,dataHora:o.Dc.now()};A.email&&(a.email=A.email),A.keyInFirestore;let r={...s.assinaturas||{},[A.keyInFirestore]:a},n="parcialmente_assinado";r.cliente?.dataHora,r.prestador?.dataHora,s.testemunhas&&s.testemunhas.length>0&&(r.testemunha1?.dataHora,s.testemunhas.length>1&&r.testemunha2?.dataHora);let d=2,l=0;r.cliente?.dataHora&&l++,r.prestador?.dataHora&&l++,s.testemunhas?.length&&(d+=s.testemunhas.length,r.testemunha1?.dataHora&&l++,s.testemunhas.length>1&&r.testemunha2?.dataHora&&l++),l===d&&(n="assinado");let c={assinaturas:r,status:n,dataUltimaModificacao:o.Dc.now()};"assinado"===n&&(c.dataFinalizacaoAssinaturas=o.Dc.now()),await (0,o.mZ)(e,c),m(e=>e?{...e,assinaturas:r,status:n,dataUltimaModificacao:c.dataUltimaModificacao,dataFinalizacaoAssinaturas:"assinado"===n?c.dataFinalizacaoAssinaturas:e.dataFinalizacaoAssinaturas}:null),t({title:"Contrato Assinado!",description:`Obrigado, ${A.name}. Sua assinatura foi registrada.`})}catch(s){console.error("Erro ao assinar contrato:",s);let e="N\xe3o foi poss\xedvel registrar sua assinatura.";"permission-denied"===s.code?e="Voc\xea n\xe3o tem permiss\xe3o para assinar este contrato ou a opera\xe7\xe3o foi bloqueada pelas regras de seguran\xe7a. Verifique se est\xe1 logado com o e-mail correto ou se o contrato permite sua assinatura.":s.message&&(e=s.message),t({title:"Erro ao Assinar",description:e,variant:"destructive"})}finally{C(!1)}};return g?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center text-center min-h-screen bg-background p-4",children:[(0,a.jsx)(c.A,{className:"h-12 w-12 animate-spin text-primary mb-4"}),(0,a.jsx)("p",{className:"text-lg text-muted-foreground",children:"Carregando contrato..."})]}):N?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-background p-4",children:(0,a.jsxs)(d.Zp,{className:"w-full max-w-lg text-center",children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"flex items-center justify-center text-destructive",children:[(0,a.jsx)(u,{className:"mr-2 h-6 w-6"})," Erro ao Carregar Contrato"]})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)("p",{className:"text-muted-foreground",children:N})}),(0,a.jsx)(d.wL,{children:(0,a.jsx)(l.$,{asChild:!0,className:"w-full",children:(0,a.jsx)(j(),{href:"/dashboard",children:"Voltar ao Painel"})})})]})}):s&&A?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-background p-4",children:(0,a.jsxs)(d.Zp,{className:"w-full max-w-2xl",children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsxs)(d.ZB,{className:"flex items-center text-2xl",children:[(0,a.jsx)(p.A,{className:"mr-3 h-7 w-7 text-primary"}),"Assinatura de Contrato Digital"]}),(0,a.jsxs)(d.BT,{children:["Contrato para: ",(0,a.jsx)("span",{className:"font-semibold",children:s.cliente?.nome||"Cliente n\xe3o informado"}),(0,a.jsx)("br",{}),"Tipo: ",(0,a.jsx)("span",{className:"font-semibold",children:"padr\xe3o"===s.tipo?"Padr\xe3o":"Emergencial"}),s.id&&(0,a.jsxs)("span",{className:"block text-xs text-muted-foreground mt-1",children:["ID: ",s.id]})]})]}),(0,a.jsxs)(d.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"p-4 border rounded-md bg-muted/50",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg mb-1",children:"Sua Fun\xe7\xe3o:"}),(0,a.jsxs)("p",{className:"text-md flex items-center",children:[(0,a.jsx)(x,{size:20,className:"mr-2 text-accent"})," ",A.roleDescription]}),A.email&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground ml-7",children:A.email})]}),(0,a.jsxs)("div",{className:"p-4 border rounded-md max-h-60 overflow-y-auto",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Objeto do Contrato (Resumo):"}),(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:s.blocosEditaveis?.objetoDoContrato||"Objeto do contrato n\xe3o especificado."}),"emergencial"===s.tipo&&s.termosEmergencial&&(0,a.jsxs)("div",{className:"mt-3 pt-3 border-t",children:[(0,a.jsx)("h4",{className:"font-semibold text-sm text-amber-700 dark:text-amber-500",children:"Termos Emergenciais Espec\xedficos:"}),(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:s.termosEmergencial}),void 0!==s.taxaDeslocamento&&(0,a.jsxs)("p",{className:"text-sm font-medium mt-1",children:["Taxa de Deslocamento: R$ ",s.taxaDeslocamento.toFixed(2)]})]}),(0,a.jsx)("p",{className:"mt-4 text-xs text-muted-foreground",children:"Este \xe9 um resumo. O documento completo ser\xe1 disponibilizado ap\xf3s todas as assinaturas."})]}),P()?(0,a.jsxs)("div",{className:"p-4 border rounded-md bg-green-100 dark:bg-green-900/70 text-green-700 dark:text-green-300 flex items-center gap-3",children:[(0,a.jsx)(h,{size:24}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:"Este contrato j\xe1 foi assinado por voc\xea."}),(0,a.jsxs)("p",{className:"text-xs",children:["Assinado em: ",s.assinaturas[A.keyInFirestore]?.dataHora?(0,b.GP)(s.assinaturas[A.keyInFirestore].dataHora.toDate(),"dd/MM/yyyy '\xe0s' HH:mm",{locale:v.F}):"Data indispon\xedvel"]})]})]}):(0,a.jsxs)("div",{className:"p-6 border-2 border-dashed border-primary/50 rounded-md text-center space-y-4 bg-background",children:[(0,a.jsx)("h3",{className:"font-semibold text-xl text-primary",children:"Confirmar Assinatura Eletr\xf4nica"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:['Ao clicar em "Assinar Contrato Digitalmente", voc\xea, ',(0,a.jsx)("span",{className:"font-bold",children:A.name}),", declara que leu, compreendeu e concorda com todos os termos e condi\xe7\xf5es do contrato apresentado. Sua assinatura digital ter\xe1 validade jur\xeddica."]}),(0,a.jsx)(l.$,{onClick:E,disabled:k||"assinado"===s.status||"cancelado"===s.status,size:"lg",className:"w-full max-w-xs mx-auto text-base py-6",children:k?(0,a.jsx)(c.A,{className:"mr-2 h-5 w-5 animate-spin"}):"Assinar Contrato Digitalmente"}),"assinado"===s.status&&(0,a.jsx)("p",{className:"text-sm text-green-600 font-medium mt-2",children:"Este contrato j\xe1 foi totalmente assinado."}),"cancelado"===s.status&&(0,a.jsx)("p",{className:"text-sm text-red-600 font-medium mt-2",children:"Este contrato foi cancelado e n\xe3o pode mais ser assinado."})]})]}),(0,a.jsxs)(d.wL,{className:"flex-col items-start text-xs text-muted-foreground space-y-1 pt-4",children:[(0,a.jsxs)("p",{children:["Em caso de d\xfavidas, entre em contato com ",s.empresaPrestador?.nome||"o prestador de servi\xe7o"," (Email: ",s.empresaPrestador?.email||s.cliente?.email||"n\xe3o informado",")."]}),(0,a.jsx)("p",{children:"Powered by ANODE Lite"})]})]})}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-background p-4",children:(0,a.jsxs)(d.Zp,{className:"w-full max-w-lg text-center",children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"flex items-center justify-center text-destructive",children:[(0,a.jsx)(u,{className:"mr-2 h-6 w-6"})," Dados Incompletos"]})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"N\xe3o foi poss\xedvel carregar os detalhes do contrato ou do assinante. Verifique se o link est\xe1 correto e tente novamente."})}),(0,a.jsx)(d.wL,{children:(0,a.jsx)(l.$,{asChild:!0,className:"w-full",children:(0,a.jsx)(j(),{href:"/dashboard",children:"Voltar ao Painel"})})})]})})}},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[447,405,707,121,277],()=>s(11246));module.exports=a})();