(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[740],{33859:(e,a,o)=>{Promise.resolve().then(o.bind(o,68569))},47262:(e,a,o)=>{"use strict";o.d(a,{S:()=>c});var r=o(95155),i=o(12115),s=o(76981),t=o(10518),n=o(59434);let c=i.forwardRef((e,a)=>{let{className:o,...i}=e;return(0,r.jsx)(s.bL,{ref:a,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",o),...i,children:(0,r.jsx)(s.C1,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(t.A,{className:"h-4 w-4"})})})});c.displayName=s.bL.displayName},68569:(e,a,o)=>{"use strict";o.r(a),o.d(a,{default:()=>el});var r=o(95155),i=o(16976),s=o(30285),t=o(66695),n=o(50172),c=o(72233),l=o(79311),d=o(15300),m=o(7390),u=o(59409),x=o(62177),h=o(90221),p=o(71153),j=o(40283),v=o(67039),b=o(35317),f=o(90858),g=o(12115),N=o(87481),A=o(66766),y=o(85057),C=o(10330),w=o(62523),E=o(965),I=o(73158),F=o(43900),B=o(59434);function R(e){let{className:a,classNames:o,showOutsideDays:i=!0,...t}=e;return(0,r.jsx)(F.hv,{showOutsideDays:i,className:(0,B.cn)("p-3",a),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,B.cn)((0,s.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,B.cn)((0,s.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...o},components:{IconLeft:e=>{let{className:a,...o}=e;return(0,r.jsx)(E.A,{className:(0,B.cn)("h-4 w-4",a),...o})},IconRight:e=>{let{className:a,...o}=e;return(0,r.jsx)(I.A,{className:(0,B.cn)("h-4 w-4",a),...o})}},...t})}R.displayName="Calendar";var D=o(20547);let T=D.bL,S=D.l9,P=g.forwardRef((e,a)=>{let{className:o,align:i="center",sideOffset:s=4,...t}=e;return(0,r.jsx)(D.ZL,{children:(0,r.jsx)(D.UC,{ref:a,align:i,sideOffset:s,className:(0,B.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",o),...t})})});P.displayName=D.UC.displayName;var z=o(51920),O=o(83013),k=o(90540);function M(e){let{control:a,errors:o,empresa:i,user:n}=e;return(0,r.jsxs)(t.Zp,{className:"mb-6",children:[(0,r.jsx)(t.aR,{children:(0,r.jsx)(t.ZB,{children:"1. Cabe\xe7alho e Identifica\xe7\xe3o"})}),(0,r.jsxs)(t.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-start mb-6 pb-4 border-b",children:[(0,r.jsxs)("div",{className:"md:col-span-1",children:[(0,r.jsx)(y.J,{className:"block mb-1 text-xs text-muted-foreground",children:"Logotipo:"}),(null==i?void 0:i.logotipo)?(0,r.jsx)("div",{className:"mt-1 w-24 h-24 border rounded-md flex items-center justify-center overflow-hidden bg-muted shadow-sm p-1",children:(0,r.jsx)(A.default,{src:i.logotipo,alt:"Logotipo da Empresa",width:96,height:96,className:"object-contain","data-ai-hint":"logo company"})}):(0,r.jsx)("div",{className:"mt-1 w-24 h-24 border rounded-md flex items-center justify-center bg-muted/30 text-xs text-muted-foreground p-2 text-center shadow-sm",children:"Sem logotipo. Configure no Perfil da Empresa."})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)(y.J,{htmlFor:"displayNomeEmpresa",className:"block mb-1 text-xs text-muted-foreground",children:"Empresa:"}),(0,r.jsx)(w.p,{id:"displayNomeEmpresa",value:(null==i?void 0:i.nome)||"Nome da Empresa n\xe3o configurado",disabled:!0,className:"mt-1 text-lg font-semibold bg-muted/30"}),!(null==i?void 0:i.nome)&&(0,r.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Visite ",(0,r.jsx)("a",{href:"/dashboard/company",className:"underline text-primary hover:text-primary/80",children:"Perfil da Empresa"})," para adicionar."]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{htmlFor:"tituloFicha",children:"T\xedtulo da Ficha"}),(0,r.jsx)(x.xI,{name:"tituloFicha",control:a,render:e=>{let{field:a}=e;return(0,r.jsx)(w.p,{id:"tituloFicha",...a,placeholder:"Ex: FICHA T\xc9CNICA â€“ QUADRO DE DISTRIBUI\xc7\xc3O"})}}),o.tituloFicha&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:o.tituloFicha.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{htmlFor:"identificacaoLocal",children:"Bloco / Apartamento / Local"}),(0,r.jsx)(x.xI,{name:"identificacaoLocal",control:a,render:e=>{let{field:a}=e;return(0,r.jsx)(w.p,{id:"identificacaoLocal",...a,placeholder:"Ex: Bloco A - Ap 204"})}}),o.identificacaoLocal&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:o.identificacaoLocal.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{htmlFor:"dataInstalacao",children:"Data da Instala\xe7\xe3o"}),(0,r.jsx)(x.xI,{name:"dataInstalacao",control:a,render:e=>{let{field:a}=e;return(0,r.jsxs)(T,{children:[(0,r.jsx)(S,{asChild:!0,children:(0,r.jsxs)(s.$,{variant:"outline",className:(0,B.cn)("w-full justify-start text-left font-normal",!a.value&&"text-muted-foreground"),children:[(0,r.jsx)(z.A,{className:"mr-2 h-4 w-4"}),a.value?(0,O.GP)(a.value,"PPP",{locale:k.F}):(0,r.jsx)("span",{children:"Escolha uma data"})]})}),(0,r.jsx)(P,{className:"w-auto p-0",children:(0,r.jsx)(R,{mode:"single",selected:a.value,onSelect:a.onChange,initialFocus:!0,locale:k.F})})]})}}),o.dataInstalacao&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:o.dataInstalacao.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{htmlFor:"responsavelTecnico",children:"Respons\xe1vel T\xe9cnico"}),(0,r.jsx)(x.xI,{name:"responsavelTecnico",control:a,defaultValue:(null==n?void 0:n.nome)||"",render:e=>{let{field:a}=e;return(0,r.jsx)(w.p,{id:"responsavelTecnico",...a})}}),o.responsavelTecnico&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:o.responsavelTecnico.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{htmlFor:"versaoFicha",children:"Vers\xe3o da Ficha"}),(0,r.jsx)(x.xI,{name:"versaoFicha",control:a,defaultValue:"v1.0",render:e=>{let{field:a}=e;return(0,r.jsx)(w.p,{id:"versaoFicha",...a,disabled:!0})}})]})]})]})}var V=o(88539),_=o(85127),L=o(34301),J=o(77223);let U={modelos:{6:[{numero:1,nome:"Ilumina\xe7\xe3o Social",disjuntor:"10A / Bip.",cabo:"1,5 mm\xb2",observacao:"Distribuir em mais de um circuito, se necess\xe1rio"},{numero:2,nome:"Tomadas Uso Geral (TUG) - Quartos",disjuntor:"15A / Bip.",cabo:"2,5 mm\xb2",observacao:"M\xe1x. 10 pontos por circuito"},{numero:3,nome:"Tomadas Uso Geral (TUG) - Sala",disjuntor:"15A / Bip.",cabo:"2,5 mm\xb2",observacao:"M\xe1x. 10 pontos por circuito"},{numero:4,nome:"Chuveiro El\xe9trico Su\xedte",disjuntor:"32A / Bip.",cabo:"6 mm\xb2",observacao:"Verificar pot\xeancia do chuveiro"},{numero:5,nome:"Tomadas Uso Espec\xedfico (TUE) - Cozinha (Bancada)",disjuntor:"20A / Bip.",cabo:"2,5 mm\xb2",observacao:"Para equipamentos de maior pot\xeancia"},{numero:6,nome:"Geladeira / Freezer",disjuntor:"15A / Bip.",cabo:"2,5 mm\xb2",observacao:"Circuito dedicado"}],8:[{numero:7,nome:"M\xe1quina de Lavar Roupa",disjuntor:"20A / Bip.",cabo:"2,5 mm\xb2",observacao:"Circuito dedicado"},{numero:8,nome:"Micro-ondas",disjuntor:"20A / Bip.",cabo:"2,5 mm\xb2",observacao:"Circuito dedicado"}],12:[{numero:9,nome:"Ar-condicionado Split Quarto 1",disjuntor:"15A / Bip.",cabo:"2,5 mm\xb2",observacao:"Verificar pot\xeancia do equipamento"},{numero:10,nome:"Ar-condicionado Split Sala",disjuntor:"20A / Bip.",cabo:"2,5 mm\xb2",observacao:"Verificar pot\xeancia do equipamento"},{numero:11,nome:"Forno El\xe9trico Embutido",disjuntor:"25A / Bip.",cabo:"4 mm\xb2",observacao:"Circuito dedicado"},{numero:12,nome:"Lava-lou\xe7as",disjuntor:"20A / Bip.",cabo:"2,5 mm\xb2",observacao:"Circuito dedicado"}],18:[{numero:13,nome:"Secadora de Roupas",disjuntor:"20A / Bip.",cabo:"2,5 mm\xb2",observacao:"Circuito dedicado"},{numero:14,nome:"Tomadas Uso Geral (TUG) - Cozinha",disjuntor:"20A / Bip.",cabo:"2,5 mm\xb2"},{numero:15,nome:"Tomadas \xc1rea de Servi\xe7o",disjuntor:"20A / Bip.",cabo:"2,5 mm\xb2"},{numero:16,nome:"Chuveiro El\xe9trico Social",disjuntor:"32A / Bip.",cabo:"6 mm\xb2",observacao:"Verificar pot\xeancia"},{numero:17,nome:"Ilumina\xe7\xe3o Servi\xe7o / Externa",disjuntor:"10A / Bip.",cabo:"1,5 mm\xb2"},{numero:18,nome:"Port\xe3o Eletr\xf4nico / Interfone",disjuntor:"10A / Bip.",cabo:"1,5 mm\xb2"}],24:[{numero:19,nome:"Ar-condicionado Split Quarto 2",disjuntor:"15A / Bip.",cabo:"2,5 mm\xb2",observacao:"Verificar pot\xeancia"},{numero:20,nome:"Bomba de Piscina / Hidro",disjuntor:"20A / Bip.",cabo:"2,5 mm\xb2",observacao:"Com prote\xe7\xe3o DR"},{numero:21,nome:"Ilumina\xe7\xe3o Jardim / Piscina",disjuntor:"10A / Bip.",cabo:"1,5 mm\xb2",observacao:"Com prote\xe7\xe3o DR"},{numero:22,nome:"Tomadas Varanda / Gourmet",disjuntor:"20A / Bip.",cabo:"2,5 mm\xb2"},{numero:23,nome:"Automa\xe7\xe3o Residencial",disjuntor:"10A / Bip.",cabo:"1,5 mm\xb2"},{numero:24,nome:"Tomadas Escrit\xf3rio / Home Office",disjuntor:"15A / Bip.",cabo:"2,5 mm\xb2"}],32:[{numero:25,nome:"Aquecedor Central / Boiler",disjuntor:"32A / Bip.",cabo:"6 mm\xb2",observacao:"Verificar pot\xeancia"},{numero:26,nome:"Painel Solar Inversor",disjuntor:"25A / Bip.",cabo:"4 mm\xb2",observacao:"Conforme projeto fotovoltaico"},{numero:27,nome:"Sistema de Seguran\xe7a (CFTV/Alarme)",disjuntor:"10A / Bip.",cabo:"1,5 mm\xb2"},{numero:28,nome:"Reservado T\xe9cnico 1",disjuntor:"20A",cabo:"2,5 mm\xb2",observacao:""},{numero:29,nome:"Reservado T\xe9cnico 2",disjuntor:"20A",cabo:"2,5 mm\xb2",observacao:""},{numero:30,nome:"Tomadas Banheiros (exceto chuveiro)",disjuntor:"15A / Bip.",cabo:"2,5 mm\xb2"},{numero:31,nome:"Ilumina\xe7\xe3o Corredores / Hall",disjuntor:"10A / Bip.",cabo:"1,5 mm\xb2"},{numero:32,nome:"Painel de Rede / Internet",disjuntor:"10A / Bip.",cabo:"1,5 mm\xb2"}],44:[{numero:33,nome:"Spa / Jacuzzi",disjuntor:"32A / Trip.",cabo:"6 mm\xb2",observacao:"Com prote\xe7\xe3o DR dedicada"},{numero:34,nome:"Carregador Ve\xedculo El\xe9trico",disjuntor:"32A / Bip.",cabo:"6 mm\xb2",observacao:"Verificar demanda"},{numero:35,nome:"Adega Climatizada",disjuntor:"10A / Bip.",cabo:"1,5 mm\xb2"},{numero:36,nome:"Quarto 1 - Tomadas Adicionais",disjuntor:"15A / Bip.",cabo:"2,5 mm\xb2"},{numero:37,nome:"Quarto 2 - Tomadas Adicionais",disjuntor:"15A / Bip.",cabo:"2,5 mm\xb2"},{numero:38,nome:"Quarto 3 / Su\xedte Master - Tomadas",disjuntor:"20A / Bip.",cabo:"2,5 mm\xb2"},{numero:39,nome:"Home Theater / Som Ambiente",disjuntor:"15A / Bip.",cabo:"2,5 mm\xb2"},{numero:40,nome:"Banheiro Social - Tomadas",disjuntor:"15A / Bip.",cabo:"2,5 mm\xb2"},{numero:41,nome:"Ilumina\xe7\xe3o Garagem / Dep\xf3sito",disjuntor:"10A / Bip.",cabo:"1,5 mm\xb2"},{numero:42,nome:"Tomadas Garagem / Oficina",disjuntor:"20A / Bip.",cabo:"2,5 mm\xb2"},{numero:43,nome:"Reservado T\xe9cnico 3",disjuntor:"20A",cabo:"2,5 mm\xb2",observacao:""},{numero:44,nome:"Reservado T\xe9cnico 4",disjuntor:"20A",cabo:"2,5 mm\xb2",observacao:""}]}},G=["6","8","12","18","24","32","44"],q="clear";function Q(e){let{control:a,errors:o,fieldArray:i,setValue:t}=e,{fields:n,append:c,remove:l,replace:d}=i;return(0,r.jsxs)(Z,{className:"mb-6",children:[(0,r.jsx)(H,{children:(0,r.jsx)($,{children:"2. Distribui\xe7\xe3o dos Circuitos"})}),(0,r.jsxs)(W,{children:[(0,r.jsxs)("div",{className:"mb-4 space-y-2",children:[(0,r.jsx)(y.J,{htmlFor:"circuitTemplateSelect",children:"Selecionar Modelo de Circuitos (NBR 5410 Padr\xf5es Residenciais)"}),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsxs)(u.l6,{onValueChange:e=>{if(e===q||!e){d([]);return}let a=parseInt(e,10),o=[],r=Object.keys(U.modelos).map(e=>parseInt(e,10)).sort((e,a)=>e-a),i=0;for(let e of r)if(i<a&&e<=a){let r=e.toString();U.modelos[r]&&U.modelos[r].forEach(e=>{o.length<a&&!o.find(a=>a.numero===e.numero)&&o.push(e)}),e>i&&(i=e)}d(o.sort((e,a)=>e.numero-a.numero).slice(0,a).map(e=>({nome:e.nome,disjuntor:e.disjuntor,caboMM:e.cabo,observacoes:e.observacao||""})))},children:[(0,r.jsx)(u.bq,{id:"circuitTemplateSelect",className:"w-full md:w-72",children:(0,r.jsx)(u.yv,{placeholder:"Escolha a quantidade de circuitos..."})}),(0,r.jsxs)(u.gC,{children:[G.map(e=>(0,r.jsxs)(u.eb,{value:e,children:[e," Circuitos"]},e)),(0,r.jsx)(u.eb,{value:q,children:"Limpar/Manual"})]})]}),(0,r.jsxs)(s.$,{type:"button",variant:"outline",onClick:()=>c({nome:"",disjuntor:"",caboMM:"",observacoes:""}),children:[(0,r.jsx)(L.A,{className:"mr-2 h-4 w-4"})," Adicionar Manual"]})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Selecionar um modelo preencher\xe1 a tabela com circuitos comuns. Voc\xea poder\xe1 edit\xe1-los."})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)(_.XI,{children:[(0,r.jsx)(_.A0,{children:(0,r.jsxs)(_.Hj,{children:[(0,r.jsx)(_.nd,{className:"w-[50px]",children:"N\xb0"}),(0,r.jsx)(_.nd,{children:"Circuito"}),(0,r.jsx)(_.nd,{children:"Disjuntor"}),(0,r.jsx)(_.nd,{children:"Cabo (mm\xb2)"}),(0,r.jsx)(_.nd,{children:"Observa\xe7\xf5es"}),(0,r.jsx)(_.nd,{className:"w-[100px] text-right",children:"A\xe7\xf5es"})]})}),(0,r.jsx)(_.BF,{children:n.map((e,i)=>{var t,n,c,d,m,u,h,p,j,v,b,f,g,N,A,y;return(0,r.jsxs)(_.Hj,{children:[(0,r.jsx)(_.nA,{children:i+1}),(0,r.jsxs)(_.nA,{children:[(0,r.jsx)(x.xI,{name:"circuitos.".concat(i,".nome"),control:a,render:e=>{let{field:a}=e;return(0,r.jsx)(w.p,{...a,placeholder:"Ex: Ilumina\xe7\xe3o Sala"})}}),(null===(n=o.circuitos)||void 0===n?void 0:null===(t=n[i])||void 0===t?void 0:t.nome)&&(0,r.jsx)("p",{className:"text-xs text-destructive mt-1",children:null===(d=o.circuitos[i])||void 0===d?void 0:null===(c=d.nome)||void 0===c?void 0:c.message})]}),(0,r.jsxs)(_.nA,{children:[(0,r.jsx)(x.xI,{name:"circuitos.".concat(i,".disjuntor"),control:a,render:e=>{let{field:a}=e;return(0,r.jsx)(w.p,{...a,placeholder:"Ex: 10A Curva B"})}}),(null===(u=o.circuitos)||void 0===u?void 0:null===(m=u[i])||void 0===m?void 0:m.disjuntor)&&(0,r.jsx)("p",{className:"text-xs text-destructive mt-1",children:null===(p=o.circuitos[i])||void 0===p?void 0:null===(h=p.disjuntor)||void 0===h?void 0:h.message})]}),(0,r.jsxs)(_.nA,{children:[(0,r.jsx)(x.xI,{name:"circuitos.".concat(i,".caboMM"),control:a,render:e=>{let{field:a}=e;return(0,r.jsx)(w.p,{...a,placeholder:"Ex: 1,5"})}}),(null===(v=o.circuitos)||void 0===v?void 0:null===(j=v[i])||void 0===j?void 0:j.caboMM)&&(0,r.jsx)("p",{className:"text-xs text-destructive mt-1",children:null===(f=o.circuitos[i])||void 0===f?void 0:null===(b=f.caboMM)||void 0===b?void 0:b.message})]}),(0,r.jsxs)(_.nA,{children:[(0,r.jsx)(x.xI,{name:"circuitos.".concat(i,".observacoes"),control:a,render:e=>{let{field:a}=e;return(0,r.jsx)(V.T,{...a,placeholder:"Opcional",rows:1})}}),(null===(N=o.circuitos)||void 0===N?void 0:null===(g=N[i])||void 0===g?void 0:g.observacoes)&&(0,r.jsx)("p",{className:"text-xs text-destructive mt-1",children:null===(y=o.circuitos[i])||void 0===y?void 0:null===(A=y.observacoes)||void 0===A?void 0:A.message})]}),(0,r.jsx)(_.nA,{className:"text-right",children:(0,r.jsx)(s.$,{type:"button",variant:"destructive",size:"sm",onClick:()=>l(i),"aria-label":"Remover Circuito",children:(0,r.jsx)(J.A,{className:"h-4 w-4"})})})]},e.id)})})]})}),o.circuitos&&"object"==typeof o.circuitos&&"message"in o.circuitos&&!Array.isArray(o.circuitos)&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-2",children:o.circuitos.message})]})]})}let Z=e=>{let{className:a,children:o}=e;return(0,r.jsx)("div",{className:K("border rounded-lg shadow-sm bg-card text-card-foreground",a),children:o})},H=e=>{let{children:a}=e;return(0,r.jsx)("div",{className:"p-6 flex flex-col space-y-1.5",children:a})},$=e=>{let{children:a}=e;return(0,r.jsx)("h3",{className:"text-2xl font-semibold leading-none tracking-tight",children:a})},W=e=>{let{className:a,children:o}=e;return(0,r.jsx)("div",{className:K("p-6 pt-0",a),children:o})};function K(){for(var e=arguments.length,a=Array(e),o=0;o<e;o++)a[o]=arguments[o];return a.filter(Boolean).join(" ")}var X=o(47262);function Y(e){let{control:a,errors:o}=e;return(0,r.jsxs)(ee,{className:"mb-6",children:[(0,r.jsx)(ea,{children:(0,r.jsx)(eo,{children:"3. Observa\xe7\xf5es T\xe9cnicas"})}),(0,r.jsxs)(er,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{children:"Norma de Refer\xeancia"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground p-2 border rounded-md bg-muted",children:"Conforme NBR 5410"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(x.xI,{name:"observacaoDR",control:a,render:e=>{let{field:a}=e;return(0,r.jsx)(X.S,{id:"observacaoDR",checked:a.value,onCheckedChange:a.onChange})}}),(0,r.jsx)(y.J,{htmlFor:"observacaoDR",className:"font-normal",children:"Observa\xe7\xe3o sobre Disjuntor DR"})]}),o.observacaoDR&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:o.observacaoDR.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{htmlFor:"descricaoDROpcional",children:"Descri\xe7\xe3o Adicional sobre DR (opcional)"}),(0,r.jsx)(x.xI,{name:"descricaoDROpcional",control:a,render:e=>{let{field:a}=e;return(0,r.jsx)(V.T,{id:"descricaoDROpcional",...a,placeholder:"Ex: Disjuntor DR n\xe3o instalado, Disjuntor DR geral de 40A/30mA"})}}),o.descricaoDROpcional&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:o.descricaoDROpcional.message})]})]})]})}let ee=e=>{let{className:a,children:o}=e;return(0,r.jsx)("div",{className:ei("border rounded-lg shadow-sm bg-card text-card-foreground",a),children:o})},ea=e=>{let{children:a}=e;return(0,r.jsx)("div",{className:"p-6 flex flex-col space-y-1.5",children:a})},eo=e=>{let{children:a}=e;return(0,r.jsx)("h3",{className:"text-2xl font-semibold leading-none tracking-tight",children:a})},er=e=>{let{className:a,children:o}=e;return(0,r.jsx)("div",{className:ei("p-6 pt-0",a),children:o})};function ei(){for(var e=arguments.length,a=Array(e),o=0;o<e;o++)a[o]=arguments[o];return a.filter(Boolean).join(" ")}function es(e){let{}=e;return(0,r.jsxs)(t.Zp,{className:"mb-6",children:[(0,r.jsxs)(t.aR,{children:[(0,r.jsx)(t.ZB,{children:"4. QR Code e Acesso Online"}),(0,r.jsx)(t.BT,{children:"Esta se\xe7\xe3o ser\xe1 preenchida automaticamente com um QR Code e um link p\xfablico para esta ficha t\xe9cnica ap\xf3s ela ser salva. (Funcionalidade em desenvolvimento)"})]}),(0,r.jsxs)(t.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{children:"QR Code da Ficha"}),(0,r.jsxs)("div",{className:"mt-2 p-4 border rounded-md bg-muted/50 flex flex-col items-center justify-center",children:[(0,r.jsx)(A.default,{src:"https://placehold.co/150x150.png?text=QR+Code",alt:"QR Code Placeholder",width:100,height:100,"data-ai-hint":"qr code"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Ser\xe1 gerado automaticamente."})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{children:"Texto de Acesso Online"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground p-2 border rounded-md bg-muted",children:"Acesso aos projetos online"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{children:"Link da Ficha T\xe9cnica P\xfablica"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground p-2 border rounded-md bg-muted",children:"Ser\xe1 gerado automaticamente."})]})]})]})}function et(e){let{control:a,errors:o,user:i,setValue:s,assinaturaPreview:n,assinaturaFile:c,onAssinaturaChange:l}=e,{toast:d}=(0,N.dj)(),[m,u]=(0,g.useState)(n||null);(0,g.useEffect)(()=>{u(n||null)},[n]);let h=e=>{var a;let o=null===(a=e.target.files)||void 0===a?void 0:a[0];if(o){if(o.size>1048576){d({title:"Arquivo muito grande",description:"A assinatura deve ter no m\xe1ximo 1MB.",variant:"destructive"}),e.target.value="",l(void 0),u(null);return}let a=new FileReader;a.onloadend=()=>{u(a.result)},a.readAsDataURL(o),l(o)}else l(void 0),u(null)};return(0,r.jsxs)(t.Zp,{className:"mb-6",children:[(0,r.jsx)(t.aR,{children:(0,r.jsx)(t.ZB,{children:"5. Assinatura e Contato"})}),(0,r.jsxs)(t.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{htmlFor:"nomeEletricista",children:"Nome do Eletricista / Respons\xe1vel"}),(0,r.jsx)(x.xI,{name:"nomeEletricista",control:a,defaultValue:(null==i?void 0:i.nome)||"",render:e=>{let{field:a}=e;return(0,r.jsx)(w.p,{id:"nomeEletricista",...a})}}),o.nomeEletricista&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:o.nomeEletricista.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{htmlFor:"assinaturaEletricistaFile",children:"Assinatura Digital (Imagem)"}),(0,r.jsx)(x.xI,{name:"assinaturaEletricistaFile",control:a,render:e=>{let{field:{onChange:a,value:o,...i}}=e;return(0,r.jsx)(w.p,{id:"assinaturaEletricistaFile",type:"file",accept:"image/png, image/jpeg, image/webp",onChange:h,className:"mt-1",...i})}}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Recomendado: Fundo transparente (PNG). M\xe1x: 1MB."}),c&&(0,r.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Arquivo selecionado: ",c.name]}),m&&(0,r.jsx)("div",{className:"mt-2 p-2 border rounded-md bg-muted/50 inline-block",children:(0,r.jsx)(A.default,{src:m,alt:"Preview da Assinatura",width:150,height:75,className:"object-contain","data-ai-hint":"signature"})}),o.assinaturaEletricistaFile&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:o.assinaturaEletricistaFile.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{htmlFor:"contatoEletricista",children:"WhatsApp / Telefone"}),(0,r.jsx)(x.xI,{name:"contatoEletricista",control:a,render:e=>{let{field:a}=e;return(0,r.jsx)(w.p,{id:"contatoEletricista",...a,placeholder:"(00) 00000-0000"})}}),o.contatoEletricista&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:o.contatoEletricista.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{htmlFor:"ramalPortaria",children:"Ramal da Portaria (opcional)"}),(0,r.jsx)(x.xI,{name:"ramalPortaria",control:a,render:e=>{let{field:a}=e;return(0,r.jsx)(w.p,{id:"ramalPortaria",...a,placeholder:"Ex: 90"})}}),o.ramalPortaria&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:o.ramalPortaria.message})]})]})]})}let en=p.z.object({nome:p.z.string().min(1,"Nome do circuito \xe9 obrigat\xf3rio."),disjuntor:p.z.string().min(1,"Disjuntor \xe9 obrigat\xf3rio."),caboMM:p.z.string().min(1,"Cabo (mm\xb2) \xe9 obrigat\xf3rio."),observacoes:p.z.string().optional()}),ec=p.z.object({clienteId:p.z.string().min(1,"Selecione um cliente."),projetoId:p.z.string().min(1,"Selecione um projeto."),tituloFicha:p.z.string().min(3,"T\xedtulo da ficha \xe9 obrigat\xf3rio."),identificacaoLocal:p.z.string().min(1,"Local/Identifica\xe7\xe3o \xe9 obrigat\xf3rio."),dataInstalacao:p.z.date({required_error:"Data de instala\xe7\xe3o \xe9 obrigat\xf3ria."}),responsavelTecnico:p.z.string().min(3,"Respons\xe1vel t\xe9cnico \xe9 obrigat\xf3rio."),versaoFicha:p.z.string().default("v1.0"),circuitos:p.z.array(en).min(1,"Adicione pelo menos um circuito."),observacaoDR:p.z.boolean().default(!1),descricaoDROpcional:p.z.string().optional(),nomeEletricista:p.z.string().min(3,"Nome do eletricista \xe9 obrigat\xf3rio."),assinaturaEletricistaFile:p.z.custom().optional(),contatoEletricista:p.z.string().min(10,"Contato do eletricista \xe9 obrigat\xf3rio."),ramalPortaria:p.z.string().optional()});function el(){let{user:e,userData:a}=(0,j.A)(),{toast:o}=(0,N.dj)(),[p,w]=(0,g.useState)([]),[E,I]=(0,g.useState)([]),[F,B]=(0,g.useState)([]),[R,D]=(0,g.useState)(null),[T,S]=(0,g.useState)(!1),[P,z]=(0,g.useState)(!0),[O,k]=(0,g.useState)(!1),[V,_]=(0,g.useState)(null),[L,J]=(0,g.useState)(void 0),{control:U,handleSubmit:G,reset:q,watch:Z,setValue:H,getValues:$,formState:{errors:W}}=(0,x.mN)({resolver:(0,h.u)(ec),defaultValues:{clienteId:"",projetoId:"",tituloFicha:"FICHA T\xc9CNICA â€“ QUADRO DE DISTRIBUI\xc7\xc3O",identificacaoLocal:"",dataInstalacao:new Date,responsavelTecnico:(null==a?void 0:a.nome)||(null==e?void 0:e.displayName)||"",versaoFicha:"v1.0",circuitos:[],observacaoDR:!1,descricaoDROpcional:"",nomeEletricista:(null==a?void 0:a.nome)||(null==e?void 0:e.displayName)||"",contatoEletricista:"",ramalPortaria:"",assinaturaEletricistaFile:void 0}}),K=(0,x.jz)({control:U,name:"circuitos"}),X=Z("clienteId"),ee="https://placehold.co/400x560.png?text=Layout+Ficha+T%C3%A9cnica",ea=(0,g.useCallback)(async()=>{if(e){z(!0);try{let a=(0,b.P)((0,b.rJ)(v.db,"clientes"),(0,b._M)("owner","==",e.uid)),o=await (0,b.GG)(a);w(o.docs.map(e=>({id:e.id,...e.data()})));let r=(0,b.P)((0,b.rJ)(v.db,"projetos"),(0,b._M)("owner","==",e.uid)),i=await (0,b.GG)(r);I(i.docs.map(e=>({id:e.id,...e.data()})));let s=(0,b.H9)(v.db,"empresas",e.uid),t=await (0,b.x7)(s);t.exists()&&D(t.data())}catch(e){o({title:"Erro ao buscar dados",description:"N\xe3o foi poss\xedvel carregar clientes, projetos ou dados da empresa.",variant:"destructive"})}finally{z(!1)}}},[e,o]);(0,g.useEffect)(()=>{ea()},[ea]),(0,g.useEffect)(()=>{if((null==a?void 0:a.nome)||(null==e?void 0:e.displayName)){let o=(null==a?void 0:a.nome)||(null==e?void 0:e.displayName)||"";H("responsavelTecnico",o,{shouldValidate:!0}),H("nomeEletricista",o,{shouldValidate:!0})}},[e,a,H]),(0,g.useEffect)(()=>{X?(B(E.filter(e=>e.clienteId===X)),H("projetoId","",{shouldValidate:!0})):B([])},[X,E,H]);let eo=async()=>{k(!0);let a=$(),r=ec.safeParse(a);if(!r.success){o({title:"Dados inv\xe1lidos",description:"Por favor, corrija os erros no formul\xe1rio antes de gerar o PDF.",variant:"destructive"}),console.error("Validation Errors:",r.error.flatten().fieldErrors),k(!1);return}let i={...r.data,owner:e.uid,logotipoEmpresaUrl:(null==R?void 0:R.logotipo)||"",nomeEmpresa:(null==R?void 0:R.nome)||"N\xe3o configurado",dataInstalacao:b.Dc.fromDate(r.data.dataInstalacao),assinaturaEletricistaUrl:V||"",observacaoNBR:"Conforme NBR 5410",textoAcessoOnline:"Acesso aos projetos online",qrCodeUrl:"",linkFichaPublica:"",dataCriacao:b.Dc.now()};try{await (0,C.M)(i),o({title:"PDF Gerado!",description:"O download da ficha t\xe9cnica foi iniciado."})}catch(e){o({title:"Erro ao gerar PDF",description:e.message||"N\xe3o foi poss\xedvel gerar o arquivo PDF.",variant:"destructive"})}finally{k(!1)}},er=async r=>{if(!e)return;S(!0);let i=V||"";if(L){let a=(0,f.KR)(v.IG,"fichasTecnicas/".concat(e.uid,"/").concat(b.Dc.now().toMillis(),"_").concat(L.name));try{let e=await (0,f.D)(a,L);i=await (0,f.qk)(e.ref)}catch(e){o({title:"Erro no upload da assinatura",variant:"destructive"}),S(!1);return}}try{let{assinaturaEletricistaFile:s,...t}=r,n={...t,owner:e.uid,logotipoEmpresaUrl:(null==R?void 0:R.logotipo)||"",nomeEmpresa:(null==R?void 0:R.nome)||"N\xe3o configurado",dataInstalacao:b.Dc.fromDate(r.dataInstalacao),versaoFicha:r.versaoFicha||"v1.0",assinaturaEletricistaUrl:i,observacaoNBR:"Conforme NBR 5410",textoAcessoOnline:"Acesso aos projetos online",qrCodeUrl:"",linkFichaPublica:"",dataCriacao:b.Dc.now()};await (0,b.gS)((0,b.rJ)(v.db,"fichasTecnicas"),n),o({title:"Ficha T\xe9cnica criada!",description:"A nova ficha t\xe9cnica foi salva com sucesso."}),q({clienteId:"",projetoId:"",tituloFicha:"FICHA T\xc9CNICA â€“ QUADRO DE DISTRIBUI\xc7\xc3O",identificacaoLocal:"",dataInstalacao:new Date,responsavelTecnico:(null==a?void 0:a.nome)||(null==e?void 0:e.displayName)||"",versaoFicha:"v1.0",circuitos:[],observacaoDR:!1,descricaoDROpcional:"",nomeEletricista:(null==a?void 0:a.nome)||(null==e?void 0:e.displayName)||"",contatoEletricista:"",ramalPortaria:"",assinaturaEletricistaFile:void 0}),_(null),J(void 0),K.replace([])}catch(e){console.error("Error creating technical sheet:",e),o({title:"Erro ao criar ficha",description:"N\xe3o foi poss\xedvel salvar a ficha t\xe9cnica.",variant:"destructive"})}finally{S(!1)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(i.A,{title:"Gera\xe7\xe3o de Fichas T\xe9cnicas",description:"Crie fichas t\xe9cnicas detalhadas para seus projetos."}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsx)("form",{onSubmit:G(er),className:"lg:col-span-2 space-y-6",children:P?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)(n.A,{className:"h-8 w-8 animate-spin text-primary"})," ",(0,r.jsx)("p",{className:"ml-2",children:"Carregando dados..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t.Zp,{children:[(0,r.jsx)(t.aR,{children:(0,r.jsx)(t.ZB,{children:"Dados Gerais do Projeto/Cliente"})}),(0,r.jsxs)(t.Wu,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{htmlFor:"clienteId",children:"Cliente"}),(0,r.jsx)(x.xI,{name:"clienteId",control:U,render:e=>{let{field:a}=e;return(0,r.jsxs)(u.l6,{onValueChange:a.onChange,value:a.value,children:[(0,r.jsx)(u.bq,{children:(0,r.jsx)(u.yv,{placeholder:"Selecione um cliente"})}),(0,r.jsx)(u.gC,{children:p.map(e=>(0,r.jsx)(u.eb,{value:e.id,children:e.nome},e.id))})]})}}),W.clienteId&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:W.clienteId.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{htmlFor:"projetoId",children:"Projeto"}),(0,r.jsx)(x.xI,{name:"projetoId",control:U,render:e=>{let{field:a}=e;return(0,r.jsxs)(u.l6,{onValueChange:a.onChange,value:a.value,disabled:!X||0===F.length,children:[(0,r.jsx)(u.bq,{children:(0,r.jsx)(u.yv,{placeholder:X?"Selecione um projeto":"Selecione um cliente primeiro"})}),(0,r.jsx)(u.gC,{children:F.map(e=>(0,r.jsx)(u.eb,{value:e.id,children:e.nome},e.id))})]})}}),W.projetoId&&(0,r.jsx)("p",{className:"text-sm text-destructive mt-1",children:W.projetoId.message})]})]})]}),(0,r.jsx)(M,{control:U,errors:W,empresa:R,user:a}),(0,r.jsx)(Q,{control:U,errors:W,fieldArray:K,setValue:H}),(0,r.jsx)(Y,{control:U,errors:W}),(0,r.jsx)(es,{}),(0,r.jsx)(et,{control:U,errors:W,user:a,setValue:H,assinaturaPreview:V,assinaturaFile:L,onAssinaturaChange:e=>{if(J(e),e){let a=new FileReader;a.onloadend=()=>{_(a.result)},a.readAsDataURL(e)}else _(null)}}),(0,r.jsxs)(s.$,{type:"submit",disabled:T||P,className:"w-full text-lg py-6",children:[T?(0,r.jsx)(n.A,{className:"mr-2 h-5 w-5 animate-spin"}):(0,r.jsx)(c.A,{className:"mr-2 h-5 w-5"})," Salvar Dados da Ficha"]})]})}),(0,r.jsx)("div",{className:"space-y-6 lg:col-span-1",children:(0,r.jsxs)(t.Zp,{children:[(0,r.jsx)(t.aR,{children:(0,r.jsx)(t.ZB,{children:"Visualiza\xe7\xe3o e A\xe7\xf5es"})}),(0,r.jsxs)(t.Wu,{className:"flex flex-col items-center justify-center p-4 bg-muted rounded-md",children:[(0,r.jsx)(A.default,{src:ee,alt:"Exemplo de Layout da Ficha T\xe9cnica",width:400,height:560,className:"rounded shadow-md w-full max-w-sm","data-ai-hint":"document layout"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"A ficha t\xe9cnica ser\xe1 gerada em PDF."}),(0,r.jsxs)("div",{className:"mt-4 flex flex-wrap gap-2 justify-center",children:[(0,r.jsxs)(s.$,{onClick:()=>{let e=document.createElement("a");e.href=ee,e.download="layout-ficha-tecnica.png",document.body.appendChild(e),e.click(),document.body.removeChild(e),o({title:"Download PNG Exemplo",description:"Baixando imagem de exemplo do layout."})},variant:"outline",size:"sm",children:[(0,r.jsx)(l.A,{className:"mr-2 h-4 w-4"})," Layout PNG (Exemplo)"]}),(0,r.jsxs)(s.$,{onClick:eo,variant:"outline",size:"sm",disabled:O||P||Object.keys(W).length>0,children:[O?(0,r.jsx)(n.A,{className:"animate-spin mr-2 h-4 w-4"}):(0,r.jsx)(d.A,{className:"mr-2 h-4 w-4"})," Baixar PDF"]}),(0,r.jsxs)(s.$,{disabled:!0,variant:"outline",size:"sm",title:"Compartilhar (em breve)",children:[(0,r.jsx)(m.A,{className:"mr-2 h-4 w-4"})," Compartilhar"]})]}),Object.keys(W).length>0&&!P&&(0,r.jsx)("p",{className:"text-xs text-destructive mt-2 text-center",children:"Corrija os erros no formul\xe1rio para baixar o PDF."})]})]})})]})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[2992,6073,3930,668,9023,7289,4641,2356,7328,7248,5886,3063,2995,974,283,6803,8441,1684,7358],()=>a(33859)),_N_E=e.O()}]);