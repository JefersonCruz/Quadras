rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Regra geral: permite leitura e escrita apenas para usuários autenticados.
    // ATENÇÃO: Esta é uma regra permissiva para desenvolvimento.
    // Em produção, você DEVE restringir o acesso por coleção e documento.
    match /{document=**} {
      allow read, write: if request.auth != null;
    }

    // Abaixo estão exemplos de como você pode começar a proteger coleções específicas.
    // Descomente e adapte conforme necessário.

    // Usuários só podem ler e escrever seus próprios documentos na coleção 'usuarios'.
    // match /usuarios/{userId} {
    //   allow read: if request.auth != null;
    //   allow write: if request.auth.uid == userId;
    // }

    // Para coleções como 'clientes', 'projetos', 'etiquetas', 'fichasTecnicas', 'contratos', 'orcamentos',
    // geralmente você quer que o usuário logado só acesse os documentos que ele criou (owner).
    // Exemplo para 'clientes':
    // match /clientes/{clienteId} {
    //   allow read, delete: if request.auth != null && resource.data.owner == request.auth.uid;
    //   allow create: if request.auth != null && request.resource.data.owner == request.auth.uid;
    //   allow update: if request.auth != null && request.resource.data.owner == request.auth.uid && resource.data.owner == request.auth.uid;
          // O 'resource.data.owner == request.auth.uid' no update garante que o owner não seja alterado.
    // }

    // Coleções globais que administradores podem gerenciar (ex: globalLabelTemplates)
    // match /globalLabelTemplates/{templateId} {
    //   allow read: if request.auth != null; // Todos podem ler templates globais
    //   allow write: if request.auth != null && get(/databases/$(database)/documents/usuarios/$(request.auth.uid)).data.role == 'admin'; // Apenas admins podem escrever
    // }

    // Para a coleção 'empresas', geralmente o usuário só pode gerenciar sua própria empresa.
    // O ID do documento da empresa é o UID do usuário.
    // match /empresas/{userId} {
    //   allow read, write: if request.auth != null && request.auth.uid == userId;
    // }
  }
}
